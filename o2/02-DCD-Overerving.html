<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DCD &amp; Overerving :: Softwareontwerp 2 (BETA)</title>
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="#">Softwareontwerp 2 (BETA)</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
      
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
          <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Producten</a>
              <div class="navbar-dropdown">
                  <a class="navbar-item" target="_blank" href="https://learn.microsoft.com/en-us/cli/azure/">Azure CLI</a>
                  <a class="navbar-item" target="_blank" href="https://www.docker.com/products/docker-desktop">Docker Desktop</a>
                  <a class="navbar-item" target="_blank" href="https://desktop.github.com/download">GitHub Desktop</a>
                  <a class="navbar-item" target="_blank" href="https://www.mysql.com/products/workbench">MySQL Workbench</a>
                  <a class="navbar-item" target="_blank" href="https://www.postman.com/downloads/">Postman</a>
                  <a class="navbar-item" target="_blank" href="https://www.jetbrains.com/rider/download">Rider</a>
                  <a class="navbar-item" target="_blank" href="https://code.visualstudio.com/download">VS Code</a>
              </div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Diensten</a>
              <div class="navbar-dropdown">
                  <a class="navbar-item" target="_blank" href="https://dev.azure.com/hogent-web4-stefancourteaux/">Azure DevOps</a>
                  <a class="navbar-item" target="_blank" href="https://portal.azure.com">Azure Portal</a>
                  <a class="navbar-item" target="_blank" href="https://chamilo.hogent.be">Chamilo</a>
                  <a class="navbar-item" target="_blank" href="https://github.com">GitHub</a>
                  <a class="navbar-item" target="_blank" href="https://jwt.io">JWT.io</a>                  
                  <a class="navbar-item" target="_blank" href="https://dotnet.microsoft.com">MS Docs</a>
              </div>
          </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="o2" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">Ontwerp 2</a></h3>
<ul class="nav-list">
      <li class="nav-item is-active" data-depth="0">
<ul class="nav-list">
      <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="01-klassen-objecten.html">Klassen &amp; Objecten</a>
  </li>
      <li class="nav-item is-active is-current-page" data-depth="1">
    <a class="nav-link" href="02-DCD-Overerving.html">DCD &amp; Overerving</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Ontwerp 2</span>
    <span class="version"></span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="index.html">Ontwerp 2</a></div>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Ontwerp 2</a></li>
    <li><a href="02-DCD-Overerving.html">DCD &amp; Overerving</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">DCD &amp; Overerving</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Een solitaire klasse voorstellen als UML is nuttig, maar een diagram wordt pas echt nuttig wanneer dit in een oogopslag overzicht biedt. Om de waarde van onze UML-diagrammen te verhogen, zullen we dus de volledige rijkdom van een OO-taal moeten leren voorstellen.</p>
</div>
<div class="paragraph">
<p>Het Domain Class Diagram (DCD) is een diagram die (een deel van) de <strong>structuur</strong> van het probleemdomein in kaart brengt. Het is een zeer technisch diagram dat nagenoeg letterlijk naar broncode vertaald kan worden.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_associaties"><a class="anchor" href="#_associaties"></a>Associaties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We hernemen de context van de vorige les, namelijk de klassen <code>Raster</code>, <code>Kasteel</code> en <code>Coordinate</code>.</p>
</div>
<div class="paragraph text-center">
<p><span class="image"><img src="_images/klassen-objecten/klassen-en-objecten-grid-3-klein.png" alt="klassen en objecten grid 3 klein"></span></p>
</div>
<div class="paragraph">
<p>Het spreekt voor zich dat deze concepten op een bepaalde manier aan elkaar gerelateerd zijn. Een <code>Raster</code> bevat meerdere kastelen en een <code>Kasteel</code> staat op een bepaalde <code>Coordinate</code>.</p>
</div>
<div class="paragraph">
<p>De <em>associaties</em> tussen deze klassen werden nog niet volledig opgenomen in onze code en UML.</p>
</div>
<div class="sect2">
<h3 id="_kasteel_coordinate"><a class="anchor" href="#_kasteel_coordinate"></a>Kasteel - Coordinate</h3>
<div class="listingblock">
<div class="title">Klasse Kasteel</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Kasteel {

    public Coordinate Positie {get; private set;} <i class="conum" data-value="1"></i><b>(1)</b>

    public int AantalVlaggetjes {get; private set;}
    public Color KleurVanDeMuren {get; private set;}

    public Kasteel(Coordinate positie, int aantalV, Color kleur) {
        Positie = positie;
        AantalVlaggetjes = aantalV;
        KleurVanDeMuren = kleur;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Een <code>Kasteel</code> bevat een <code>Coordinate</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We brengen de associatie - het verband - tussen <code>Kasteel</code> en <code>Coordinate</code> in kaart.</p>
</div>
<div class="paragraph text-center">
<p><span class="image"><img src="_images/dcd/dcd-kasteel-positie.png" alt="dcd kasteel positie"></span></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Klassen</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>De klasse <code>Kasteel</code>.</p>
</li>
<li>
<p>De klasse <code>Coordinate</code>.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Associatie</dt>
<dd>
<p>Een associatie (een lijn) die <code>Kasteel</code> en <code>Coordinate</code> verbindt.</p>
<div class="ulist">
<ul>
<li>
<p><strong>navigeerbaarheid</strong> <br>
Ze loopt in één enkele richting van <code>Kasteel</code> naar <code>Coordinate</code>. Dit wil zeggen dat de klasse <code>Kasteel</code> een <code>Coordinate</code> kent als eigenschap, maar niet omgekeerd.</p>
</li>
<li>
<p><strong>multipliciteit</strong><br>
Ze specifieert het aantal <code>Coordinate</code> objecten, namelijk 1, in deze relatie.</p>
</li>
<li>
<p><strong>eigenschap</strong><br>
Ze specifieert de naam (<code>Positie</code>) en visibiliteit  (<code>+ &#8658; public</code>) van de eigenschap waaronder de associatie in de broncode van <code>Kasteel</code> gekend is. In C# zal dit meestal een <code>Property</code> zijn.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Wanneer de associatie in twee richtingen bestaat, laten we de pijl en het kruis vallen.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Alle multipliciteiten zijn uit te drukken als <code>n..m</code> maar kunnen vaak korter geschreven worden.<br>
<br>
<code>1</code> &#8658; exact 1<br>
<code>*</code> &#8658; 1 of meer<br>
<code>0..1</code> &#8658; 1, optioneel<br>
<code>0..*</code> &#8658; veel, optioneel<br>
<br>
Meestal komt het er op neer dat we willen weten of het veld verplicht is en het een lijst of enkelvoudige waarde is. Varianten daarop hebben weinig tot geen impact op het ontwerp.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_raster_kasteel"><a class="anchor" href="#_raster_kasteel"></a>Raster - Kasteel</h3>
<div class="paragraph">
<p>Als we kracht van klassen verder willen benutten, zou het een goed idee zijn de associatie tussen <code>Raster</code> en <code>Kasteel</code> te concretiseren.</p>
</div>
<div class="paragraph text-center">
<p><span class="image"><img src="_images/dcd/dcd-raster.png" alt="dcd raster"></span></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Associatie</dt>
<dd>
<p>Een associatie (een lijn) die <code>Raster</code> en <code>Kasteel</code> verbindt.</p>
<div class="ulist">
<ul>
<li>
<p><strong>navigeerbaarheid</strong> <br>
Ze loopt in één enkele richting van <code>Raster</code> naar <code>Kasteel</code>. Dit wil zeggen dat de klasse <code>Raster</code> een <code>Kasteel</code> kent als eigenschap, maar niet omgekeerd.</p>
</li>
<li>
<p><strong>multipliciteit</strong><br>
Ze specifieert het aantal <code>Kasteel</code> objecten, namelijk "veel, optioneel", in deze relatie.</p>
</li>
<li>
<p><strong>eigenschap</strong><br>
Ze specifieert de naam (<code>Kastelen</code>) en visibiliteit  (<code>+ &#8658; public</code>) van de eigenschap waaronder de associatie in de broncode van <code>Raster</code> gekend is. In C# zal dit vaak, maar niet altijd, een <code>Property</code> zijn.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Klasse Raster</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Raster {

    public int Breedte {get; private set;}
    public int Hoogte {get; private set;}

    public List&lt;Kasteel&gt; Kastelen {get, private set;} <i class="conum" data-value="1"></i><b>(1)</b>

    public Raster(int b, int h) {
        Breedte = b;
        Hoogte = h;
        kastelen = new();
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>De lijst van kastelen wordt opgenomen in de broncode van <code>Kasteel</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Intussen hebben we al heel wat bruikbare structuur en semantische rijkdom in het DCD en de C# code.</p>
</div>
<div class="listingblock">
<div class="title">Voorbeeld Gebruik</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">var raster = new Raster(3,3);

var kasteel1 = new Kasteel( new Coordinate(0,2), 3, Color.Cyan );
raster.Kastelen.Add(kasteel1);

var kasteel2 = new Kasteel( new Coordinate(1,0), 3, Color.Blue );
raster.Kastelen.Add(kasteel2);

var kasteel3 = new Kasteel( new Coordinate(2,1), 3, Color.Cyan );
raster.Kastelen.Add(kasteel3);

foreach( var k in raster.Kastelen )
    Console.WriteLine(
        $"Een {k.Color} kasteel op {k.Positie.X},{k.Positie.Y}."
    );</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_prinses"><a class="anchor" href="#_prinses"></a>Prinses</h3>
<div class="paragraph">
<p>We breiden het scenario verder uit door toevoeging van een <code>Prinses</code>. Elk kasteel <strong>kan</strong> bewoond zijn door een <code>Prinses</code>. Een prinses heeft altijd een <code>Naam</code> en een <code>Beschrijving</code>.</p>
</div>
<div class="paragraph text-center">
<p><span class="image"><img src="_images/dcd/kasteel-prinses.png" alt="kasteel prinses"></span></p>
</div>
<div class="paragraph">
<p>We voegen de klasse toe op het DCD, rekening houdende met de verkregen informatie.</p>
</div>
<div class="paragraph text-center">
<p><span class="image"><img src="_images/dcd/dcd-prinses.png" alt="dcd prinses"></span></p>
</div>
<div class="paragraph">
<p>We schrijven code voor de klasse <code>Prinses</code>.</p>
</div>
<div class="listingblock">
<div class="title">Klasse Prinses</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Prinses {

    public string Naam {get; private set;}
    public string Beschrijving {get; private set;}

    public Prinses(string naam, string beschrijving)
    {
        Naam = naam;
        Beschrijving = beschrijving;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We passen de klasse <code>Kasteel</code> aan. Deze krijgt een nieuwe property <code>Prinses</code>. Op het DCD zien we dat de <code>Prinses</code> <strong>geen</strong> deel uitmaakt van de <code>Kasteel</code> constructor. Een <code>Kasteel</code> kan dus bestaan zonder <code>Prinses</code>. We kunnen concluderen dat het een <em>gewone</em> publieke property is.</p>
</div>
<div class="listingblock">
<div class="title">Klasse Kasteel</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Kasteel {

    public Coordinate Positie {get; private set;}

    public int AantalVlaggetjes {get; private set;}
    public Color KleurVanDeMuren {get; private set;}

    public Prinses Prinses {get; set;} <i class="conum" data-value="1"></i><b>(1)</b>

    public Kasteel(Coordinate positie, int aantalV, Color kleur) {
        Positie = positie;
        AantalVlaggetjes = aantalV;
        KleurVanDeMuren = kleur;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>De <code>Prinses</code> als publieke property.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We kunnen een <code>Prinses</code> object toewijzen aan een bestaand <code>Kasteel</code>.</p>
</div>
<div class="listingblock">
<div class="title">Gebruik Prinses</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">var kasteel1 = new Kasteel(new Coordinate(0,2), 3, Color.Cyan);
var pruts = new Prinses("Pruts", "Eet graag taartjes");
kasteel1.Prinses = pruts;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We kunnen hier gebruik van maken om te controleren of een <code>Kasteel</code> bewoond is.</p>
</div>
<div class="listingblock">
<div class="title">Voorbeeld Gebruik</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">var raster = new Raster(3,3);

var kasteel1 = new Kasteel( new Coordinate(0,2), 3, Color.Cyan );
kasteel1.Prinses = new Prinses("Pruts", "Eet graag taartjes"); <i class="conum" data-value="1"></i><b>(1)</b>
raster.Kastelen.Add(kasteel1);

var kasteel2 = new Kasteel( new Coordinate(1,0), 3, Color.Blue );
raster.Kastelen.Add(kasteel2);

var kasteel3 = new Kasteel( new Coordinate(2,1), 3, Color.Cyan );
kasteel3.Prinses = new Prinses("Tuttebel", "Heeft kleine voetjes");
raster.Kastelen.Add(kasteel3);


foreach( var k in raster.Kastelen )
{
    Console.WriteLine($"{k.Color} kasteel op {k.Positie.X},{k.Positie.Y}.");
    if( k.Prinses is not null ) <i class="conum" data-value="2"></i><b>(2)</b>
        Console.WriteLine("Het is bewoond!");
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Het <code>Kasteel</code> krijgt een <code>Prinses</code> toegewezen voor we dit toevoegen aan het <code>Raster</code>. Dat is een logisch moment, maar geen noodzaak. Het <code>Raster</code> heeft immers <em>gewoon</em> een referentie naar de verschillende <code>Kasteel</code> objecten, <strong>géén</strong> kopijen.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We controleren of de <code>Prinses</code> ingevuld is voor het <code>Kasteel</code> dat behandeld wordt. Daaruit kunnen we concluderen of het <code>Kasteel</code> bewoond is.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overerving"><a class="anchor" href="#_overerving"></a>Overerving</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Een <code>Kasteel</code> dat enkel bewoond wordt door een <code>Prinses</code> kan natuurlijk niet functioneren. Iemand moet het échte werk doen. We introduceren <code>Ridder</code>, <code>Stalknecht</code> en <code>Kok</code>.</p>
</div>
<div class="sect2">
<h3 id="_nieuwe_bewoners"><a class="anchor" href="#_nieuwe_bewoners"></a>Nieuwe Bewoners</h3>
<div class="ulist">
<ul>
<li>
<p>Een <code>Ridder</code> heeft een <code>Naam</code> en een <code>ZwaardLengte</code>.</p>
</li>
<li>
<p>Een <code>Stalknecht</code> heeft een <code>Naam</code>.</p>
</li>
<li>
<p>Een <code>Kok</code> heeft een <code>Naam</code> en een <code>Specialiteit</code>.</p>
</li>
<li>
<p>Elke klasse heeft een constructor met de vereiste eigenschappen.</p>
</li>
<li>
<p>Een <code>Kasteel</code> kan <code>0..*</code> van alle klassen hebben.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We voegen de nieuwe klassen toe aan het DCD, rekening houdende met de verkregen informatie.</p>
</div>
<div class="paragraph text-center">
<p><span class="image"><img src="_images/dcd/overerving-pre.png" alt="overerving pre"></span></p>
</div>
<div class="paragraph">
<p>Dit vertaalt zich naar drie nieuwe C# klassen.</p>
</div>
<div class="listingblock">
<div class="title">Klasse Ridder</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Ridder {

    public string Naam {get; private set;}
    public int ZwaardLengte {get; private set;}

    public Ridder(string naam, int zwaardLengte)
    {
        Naam = naam;
        ZwaardLengte = zwaardLengte;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Klasse Stalknecht</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Stalknecht {

    public string Naam {get; private set;}

    public Stalknecht(string naam)
    {
        Naam = naam;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Klasse Kok</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Kok {

    public string Naam {get; private set;}
    public string Specialiteit {get; private set;}

    public Kok(string naam, string specialiteit)
    {
        Naam = naam;
        Specialiteit = specialiteit;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>De klasse <code>Kasteel</code> wordt wederom uitgebreid.</p>
</div>
<div class="listingblock">
<div class="title">Klasse Kasteel</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Kasteel {

    public Coordinate Positie {get; private set;}

    public int AantalVlaggetjes {get; private set;}
    public Color KleurVanDeMuren {get; private set;}

    // bewoners
    public Prinses Prinses {get; set;}
    public List&lt;Ridder&gt; Ridders {get; set;}
    public List&lt;Kok&gt; Koks {get; set;}
    public List&lt;Stalknecht&gt; Stalknechten {get; set;}

    public Kasteel(Coordinate positie, int aantalV, Color kleur) {
        Positie = positie;
        AantalVlaggetjes = aantalV;
        KleurVanDeMuren = kleur;
        Ridders = new();
        Koks = new();
        Stalknechten = new();
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_probleem"><a class="anchor" href="#_probleem"></a>Probleem</h3>
<div class="paragraph">
<p>Tijd om ook deze klassen te integreren in het lopend voorbeeldscenario.</p>
</div>
<div class="listingblock">
<div class="title">Voorbeeldscenario</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">var raster = new Raster(3,3);

var kasteel1 = new Kasteel( new Coordinate(0,2), 3, Color.Cyan );
kasteel1.Prinses = new Prinses("Pruts", "Eet graag taartjes");
kasteel1.Ridders.Add(new Ridder("Rand", 150));
kasteel1.Ridders.Add(new Ridder("Mat", 130));
kasteel1.Ridders.Add(new Ridder("Perrin", 140));
kasteel1.Koks.Add(new Kok("Loial", "A volonté");
raster.Kastelen.Add(kasteel1);

var kasteel2 = new Kasteel( new Coordinate(1,0), 3, Color.Blue );
kasteel2.Stalknechten.Add(new Stalknecht("Ged"));
kasteel2.Stalknechten.Add(new Stalknecht("Tenar"));
raster.Kastelen.Add(kasteel2);

var kasteel3 = new Kasteel( new Coordinate(2,1), 3, Color.Cyan );
kasteel3.Prinses = new Prinses("Tuttebel", "Heeft kleine voetjes");
kasteel3.Ridders.Add(new Ridder("Lan", 150));
raster.Kastelen.Add(kasteel3);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ook deze keer zullen we bekijken of de kastelen bewoond zijn.</p>
</div>
<div class="listingblock">
<div class="title">Voorbeeldscenario</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">foreach( var k in raster.Kastelen )
{
    Console.WriteLine($"{k.Color} kasteel op {k.Positie.X},{k.Positie.Y}.");

    // is het kasteel bewoond?
    if( k.Prinses is not null || k.Ridders.Any()
        || k.Koks.Any() || k.Stalknechten.Any())
        Console.WriteLine("Het is bewoond!");
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>De logica om te bepalen of een <code>Kasteel</code> bewoond is, werd een stuk complexer. We zouden deze logica kunnen <em>encapsuleren</em> in de klasse <code>Kasteel</code>, maar ook dan zal een nieuw type bewoner steeds impact hebben op dit stuk logica.</p>
</div>
</div>
<div class="sect2">
<h3 id="_oplossing"><a class="anchor" href="#_oplossing"></a>Oplossing</h3>
<div class="paragraph">
<p>We kunnen, en zullen, ervoor kiezen de kracht van onze OO-taal te benutten om dit probleem op te lossen door het ontwerp aan te passen zodat de logica eenvoudig blijft.</p>
</div>
<div class="paragraph">
<p><code>Ridder</code>, <code>Prinses</code>, <code>Stalknecht</code>, <code>Kok</code> - ze hebben allen hun eigenheid, maar per slot van rekening zijn het allemaal bewoners van het kasteel. We kunnen gebruik maken van <em>overerving</em> om dit gegeven op te nemen in ons softwareontwerp.</p>
</div>
<div class="paragraph">
<p>We introduceren de klasse <code>Bewoner</code> en laten <code>Ridder</code>, <code>Prinses</code>, <code>Stalknecht</code> en <code>Kok</code> ervan <em>overerven</em>. De gemeenschappelijke eigenschappen (en eventueel gedrag) brengen we onder in de <em>parent</em> klasse <code>Bewoner</code>. De <em>child</em> klassen <code>Ridder</code>, <code>Prinses</code>, <code>Stalknecht</code> en <code>Kok</code> behouden wat hen uniek maakt.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/dcd/overerving-post.png" alt="overerving post"></span></p>
</div>
<div class="paragraph">
<p>Eerder besproken associaties, bijvoorbeeld <code>Kasteel</code> - <code>Coordinate</code> zijn van het type "heeft een". Een <code>Kasteel</code> <em>heeft een</em> <code>Coordinate</code>.</p>
</div>
<div class="paragraph">
<p>Bij overerving betreft het een "is een" relatie. Een <code>Prinses</code> <em>is een</em> <code>Bewoner</code>. Alle prinsessen zijn bewoners, maar niet alle bewoners zijn prinsessen.</p>
</div>
<div class="paragraph">
<p>Wanneer we het DCD herzien, impliceert dit dat we ook de code moeten herzien.</p>
</div>
<div class="listingblock">
<div class="title">Klasse Bewoner</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Bewoner {

    public string Naam {get; private set;}

    public Bewoner(string naam)
    {
        Naam = naam;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Klasse Ridder</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Ridder : Bewoner { <i class="conum" data-value="1"></i><b>(1)</b>

    public int ZwaardLengte {get; private set;}

    public Ridder(string naam, int zwaardLengte) : base(naam) <i class="conum" data-value="2"></i><b>(2)</b>
    {
        ZwaardLengte = zwaardLengte;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>Ridder</code> <em>erft over</em> van <code>Bewoner</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>De constructor geeft input voor de gedeelde eigenschappen door naar de <em>parent</em>- of <em>super</em> klasse.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Klasse Stalknecht</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Stalknecht : Bewoner {

    public Stalknecht(string naam): base(naam)
    {
        <i class="conum" data-value="1"></i><b>(1)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Een <code>Stalknecht</code> heeft geen specifieke eigenschappen dus we moeten hier niets doen. Is de klasse dan nutteloos? Neen, want we willen een bewoner kunnen identificeren als <code>Stalknecht</code>. Dat heeft waarde.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Klasse Kok</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Kok : Bewoner {

    public string Specialiteit {get; private set;}

    public Kok(string naam, string specialiteit) : base(naam)
    {
        Specialiteit = specialiteit;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ook <code>Kasteel</code> is onderhevig aan veranderingen. We reduceren de complexiteit hier door de ontwerpaanpassing.</p>
</div>
<div class="listingblock">
<div class="title">Klasse Kasteel</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Kasteel {

    public Coordinate Positie {get; private set;}

    public int AantalVlaggetjes {get; private set;}
    public Color KleurVanDeMuren {get; private set;}

    public List&lt;Bewoner&gt; Bewoners {get; set;} <i class="conum" data-value="1"></i><b>(1)</b>

    public Kasteel(Coordinate positie, int aantalV, Color kleur) {
        Positie = positie;
        AantalVlaggetjes = aantalV;
        KleurVanDeMuren = kleur;
        Bewoners = new();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Een lijst van <code>Bewoner</code> kan objecten bevatten van bewoner en diens subtypes.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Voorbeeldscenario</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">var raster = new Raster(3,3);

var kasteel1 = new Kasteel( new Coordinate(0,2), 3, Color.Cyan );
kasteel1.Bewoners.Add(new Prinses("Pruts", "Eet graag taartjes"));
kasteel1.Bewoners.Add(new Ridder("Rand", 150));
kasteel1.Bewoners.Add(new Ridder("Mat", 130));
kasteel1.Bewoners.Add(new Ridder("Perrin", 140));
kasteel1.Bewoners.Add(new Kok("Loial", "A volonté");
raster.Kastelen.Add(kasteel1);

var kasteel2 = new Kasteel( new Coordinate(1,0), 3, Color.Blue );
kasteel2.Bewoners.Add(new Stalknecht("Ged"));
kasteel2.Bewoners.Add(new Stalknecht("Tenar"));
raster.Kastelen.Add(kasteel2);

var kasteel3 = new Kasteel( new Coordinate(2,1), 3, Color.Cyan );
kasteel3.Bewoners.Add(new Prinses("Tuttebel", "Heeft kleine voetjes"));
kasteel3.Bewoners.Add(new Ridder("Lan", 150));
raster.Kastelen.Add(kasteel3);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ook deze keer zullen we bekijken of de kastelen bewoond zijn.</p>
</div>
<div class="listingblock">
<div class="title">Voorbeeldscenario</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">foreach( var k in raster.Kastelen )
{
    Console.WriteLine($"{k.Color} kasteel op {k.Positie.X},{k.Positie.Y}.");

    if(k.Bewoners.Any()) <i class="conum" data-value="1"></i><b>(1)</b>
        Console.WriteLine("Het is bewoond!");
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>De code is dermate eenvoudig en semantisch rijk, dat ze voor zich spreekt.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_type_controleren"><a class="anchor" href="#_type_controleren"></a>Type Controleren</h3>
<div class="paragraph">
<p>We kunnen ook dynamisch controleren of een object van een bepaald subtype is en conditionele logica uitvoeren.</p>
</div>
<div class="listingblock">
<div class="title">Type Controleren</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">foreach( var k in raster.Kastelen )
{
    foreach( var bewoner in k.Bewoners ) <i class="conum" data-value="1"></i><b>(1)</b>
      if ( bewoner is Prinses pr ) <i class="conum" data-value="2"></i><b>(2)</b>
        Console.WriteLine($"{pr.Naam}: {pr.Beschrijving}"); <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We overlopen alle <code>Bewoners</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We kijken of de huidige <code>bewoner</code> een <code>Prinses</code> is. Zoja, wordt deze als <code>Prinses</code> in de <code>pr</code> variabele gestopt.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We vragen de <code>Beschrijving</code> op. Dit kan alleen werken voor een <code>Prinses</code>, andere klassen hebben die property immers niet.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interfaces"><a class="anchor" href="#_interfaces"></a>Interfaces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Er breekt onrust uit rond het <code>Kasteel</code> en er moet gevochten worden. Niet alle bewoners worden verondersteld de strijd aan te gaan. De <code>Ridder</code> en de <code>Stalknecht</code> wel, de <code>Prinses</code> en de <code>Kok</code> niet.</p>
</div>
<div class="paragraph">
<p>Ook dit is een probleem dat we kunnen oplossen door conditionele logica te programmeren, of door het ontwerp aan te passen. We opteren - uiteraard - voor de ontwerpaanpassing.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/dcd/interfaces.png" alt="interfaces"></span></p>
</div>
<div class="paragraph">
<p>Bij overerving betreft het een "is een" relatie. Een <code>Prinses</code> <em>is een</em> <code>Bewoner</code>. Alle prinsessen zijn bewoners, maar niet alle bewoners zijn prinsessen.</p>
</div>
<div class="paragraph">
<p>In het geval van <em>interfaces</em>, betreft het een "implementeert een" relatie. <code>Ridder</code> implementeert <code>IStrijder</code>. Interfaces worden gebruikt om de aanwezigheid van bepaald gedrag (methoden) af te dwingen. Wanneer een klasse aangeeft een interface te implementeren, zal de compiler aanwezigheid van de relevante methodes controleren.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Een klasse kan veel associaties hebben, kan overerven van maximaal klassen en van veel interfaces implementeren.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Wanneer we het DCD herzien, impliceert dit dat we ook de code moeten herzien.</p>
</div>
<div class="listingblock">
<div class="title">Interface Strijder</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public interface IStrijder {
    public void Strijd();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Klasse Ridder</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Ridder : Bewoner, IStrijder { <i class="conum" data-value="1"></i><b>(1)</b>

    public int ZwaardLengte {get; private set;}

    public Ridder(string naam, int zwaardLengte) : base(naam) <i class="conum" data-value="2"></i><b>(2)</b>
    {
        ZwaardLengte = zwaardLengte;
    }

    public void Strijd() <i class="conum" data-value="2"></i><b>(2)</b>
    {
        Console.WriteLine("Hakt de vijand in twee met zijn zwaard");
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Belofte dat we <code>IStrijder</code> methodes gaan implementeren.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Implementatie.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Klasse Stalknecht</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">public class Stalknecht : Bewoner, IStrijder { <i class="conum" data-value="1"></i><b>(1)</b>

    public Stalknecht(string naam): base(naam)
    {
    }

    public void Strijd() <i class="conum" data-value="2"></i><b>(2)</b>
    {
        Console.WriteLine("Steekt zijn mestvork in de vijand.");
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Belofte dat we <code>IStrijder</code> methodes gaan implementeren.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Andere implementatie, eigen aan deze klasse.</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_type_controleren_2"><a class="anchor" href="#_type_controleren_2"></a>Type Controleren</h3>
<div class="paragraph">
<p>We hebben een lijst van het type <code>Bewoner</code> met daarin objecten van <code>Ridder</code>, <code>Stalknecht</code>, <code>Prinses</code> en <code>Kok</code>. Sommige van die klassen implementeren <code>IStrijder</code>.</p>
</div>
<div class="paragraph">
<p>We kunnen <code>Bewoners</code> uit de lijst typechecken op het implementeren van de <code>IStrijder</code> interface en conditioneel de <code>Strijd()</code> methode aanroepen, die op zijn beurt een andere implementatie per type kan hebben.</p>
</div>
<div class="listingblock">
<div class="title">Type Controleren</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">foreach( var k in raster.Kastelen )
{
    foreach( var bewoner in k.Bewoners )
      if ( bewoner is IStrijder strijder )
        strijder.Strijd();
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_aandachtspunt"><a class="anchor" href="#_aandachtspunt"></a>Aandachtspunt</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Let er op dat je geen <code>Bewoner</code> hoeft te zijn om een <code>IStrijder</code> te implementeren.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/dcd/interfaces-hond.png" alt="interfaces hond"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_oefening"><a class="anchor" href="#_oefening"></a>Oefening</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Start een nieuwe dotnet solution.</p>
</li>
<li>
<p>Implementeer het uiteindelijke DCD van deze les <em>from scratch</em> in C#.</p>
</li>
<li>
<p>Bedenk en implementeer een test scenario dat gebruik maakt van de verschillende klassen.</p>
</li>
</ul>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using a customized version of the Antora default UI.</p>
  <p>The source code for the default UI is licensed under the terms of the MPL-2.0 license.</p>
    <p>Content by stefan.courteaux@hogent.be for HOGENT.</p>
</footer>
<script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
