<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>State Pattern (2 Lessen) :: Softwareontwerp 2 (BETA)</title>
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="#">Softwareontwerp 2 (BETA)</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
      
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
          <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Producten</a>
              <div class="navbar-dropdown">
                  <a class="navbar-item" target="_blank" href="https://learn.microsoft.com/en-us/cli/azure/">Azure CLI</a>
                  <a class="navbar-item" target="_blank" href="https://www.docker.com/products/docker-desktop">Docker Desktop</a>
                  <a class="navbar-item" target="_blank" href="https://desktop.github.com/download">GitHub Desktop</a>
                  <a class="navbar-item" target="_blank" href="https://www.mysql.com/products/workbench">MySQL Workbench</a>
                  <a class="navbar-item" target="_blank" href="https://www.postman.com/downloads/">Postman</a>
                  <a class="navbar-item" target="_blank" href="https://www.jetbrains.com/rider/download">Rider</a>
                  <a class="navbar-item" target="_blank" href="https://code.visualstudio.com/download">VS Code</a>
              </div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Diensten</a>
              <div class="navbar-dropdown">
                  <a class="navbar-item" target="_blank" href="https://dev.azure.com/hogent-web4-stefancourteaux/">Azure DevOps</a>
                  <a class="navbar-item" target="_blank" href="https://portal.azure.com">Azure Portal</a>
                  <a class="navbar-item" target="_blank" href="https://chamilo.hogent.be">Chamilo</a>
                  <a class="navbar-item" target="_blank" href="https://github.com">GitHub</a>
                  <a class="navbar-item" target="_blank" href="https://jwt.io">JWT.io</a>                  
                  <a class="navbar-item" target="_blank" href="https://dotnet.microsoft.com">MS Docs</a>
              </div>
          </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="o2" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">Ontwerp 2</a></h3>
<ul class="nav-list">
      <li class="nav-item is-active" data-depth="0">
<ul class="nav-list">
      <li class="nav-item is-active" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Basis OO Ontwerp</span>
<ul class="nav-list">
      <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="01-klassen-objecten.html">Klassen &amp; Objecten</a>
  </li>
      <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="02-DCD-Overerving.html">DCD &amp; Overerving</a>
  </li>
      <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="03-RDD-GRASP.html">GRASP &amp; SSD</a>
  </li>
      <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="04-opdracht.html">Oefening Scheepvaart</a>
  </li>
</ul>
  </li>
      <li class="nav-item is-active" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Design Patterns</span>
<ul class="nav-list">
      <li class="nav-item is-active is-current-page" data-depth="2">
    <a class="nav-link" href="11-patterns-game.html">State Pattern (2 Lessen)</a>
  </li>
      <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="12-opdracht.html">Groepswerk</a>
  </li>
      <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="13-presentaties.html">Presentaties</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Ontwerp 2</span>
    <span class="version"></span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="index.html">Ontwerp 2</a></div>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Ontwerp 2</a></li>
    <li>Design Patterns</li>
    <li><a href="11-patterns-game.html">State Pattern (2 Lessen)</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">State Pattern (2 Lessen)</h1>
<div class="sect1">
<h2 id="_inleiding_design_patterns"><a class="anchor" href="#_inleiding_design_patterns"></a>Inleiding Design Patterns</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Design Patterns</em> (Ontwerppatronen) zijn typische oplossingen voor vaak voorkomende problemen in softwareontwerp.</p>
</div>
<div class="paragraph">
<p>Een patroon is geen specifiek stuk code, maar wel een conceptuele oplossing. Je kan dus niet zomaar een patroon kiezen en het in je programma kopiëren, zoals je met bijvoorbeeld Nuget packages doet.</p>
</div>
<div class="paragraph">
<p>Je volgt de blauwdruk van het patroon en bouwt zelf een concrete oplossing die past bij de realiteit van je eigen programma.</p>
</div>
<div class="paragraph">
<p><a href="https://refactoring.guru/design-patterns">Refactoring Guru</a> is een prachtige bron om meer te leren over <em>Design Patters</em> en <em>Refactoring</em>.</p>
</div>
<div class="quoteblock">
<blockquote>
This site shows you the big picture, how all these subjects intersect, work together, and are still relevant. I don’t pretend to be the inventor of these concepts—most of them were invented by others during the past 20 years. But I think that the connection between refactoring, patterns and general programming principles still remains a mystery for the majority of programmers. This is the problem I would like to solve here.
</blockquote>
<div class="attribution">
&#8212; Alexander Shvets<br>
<cite>The one-man band behind Refactoring.Guru</cite>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_state_in_business_software"><a class="anchor" href="#_state_in_business_software"></a>State In Business Software</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Het <em>State Pattern</em> kan toegepast worden wanneer bepaalde domeinlogica sterk onderhevig is aan de notie van toestand, of <em>State</em>. We bedoelen daarmee <strong>niet</strong> de algemene <strong>toestand</strong> van het <strong>geheugen</strong> van de computer, maar <strong>wel</strong> het onderscheiden van <strong>discrete toestanden</strong> in de <strong>logica</strong>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
De gedetailleerde blauwdruk voor het State Pattern kan je bekijken op <a href="https://refactoring.guru/design-patterns/state">Refactoging Guru</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Zo kent een document op een wiki kent bijvoorbeeld verschillende toestanden.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Draft</p>
</li>
<li>
<p>Review</p>
</li>
<li>
<p>Published</p>
</li>
<li>
<p>Rejected</p>
</li>
<li>
<p>Archived</p>
</li>
<li>
<p>Etc</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Het gedrag van de applicatie zal verschillen naargelang de <em>State</em> van het document dat behandeld wordt door de logica.</p>
</div>
<div class="paragraph">
<p>Dit kan je implementeren op enkele low-tech manieren</p>
</div>
<div class="ulist">
<ul>
<li>
<p>booleans en ifs</p>
</li>
<li>
<p>strings en switches</p>
</li>
<li>
<p>&#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Code met veel states en state-afhankelijke logica kan moeilijk leesbaar en onderhoudbaar worden.</p>
</div>
<div class="paragraph">
<p>Het <em>State Pattern</em> lost dit op door <em>States</em> expliciet te introduceren als klasses. State-eigen logica wordt hierin vervat. <em>States</em> erven van een gemeenschappelijke <code>base()</code>. Het object onderhevig aan <em>State</em> krijgt een state implementatie toegewezen en delegeert vervolgens de state-afhankelijke methodeaanroepen naar het <em>State</em> object. <em>States</em> krijgen het recht om de huidige <em>State</em> op het state-afhankelijke object te veranderen.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_state_in_videogames"><a class="anchor" href="#_state_in_videogames"></a>State In Videogames</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Videogames zijn een sprekend voorbeeld van logica die onderhevig is aan <em>state</em>.</strong></p>
</div>
<div class="paragraph">
<p>Een klassieke videogame kent enkele duidelijk te onderscheiden states waarin de uit te voeren logica sterk verschilt.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>StartScreen</p>
</li>
<li>
<p>Playing</p>
</li>
<li>
<p>Paused</p>
</li>
<li>
<p>Game Over</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We kunnen deze states én de toegelaten overgangen in kaart brengen.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/game/gamestates.png" alt="gamestates">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_doel"><a class="anchor" href="#_doel"></a>Doel</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>We bouwen een piepkleine videogame rond het <em>State Pattern</em>.</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hersenen activeren door een nieuw soort problemen op te lossen.</p>
</li>
<li>
<p>Refactoring van klassieke code door het toepassen van een pattern.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We maken een klein 2D spelletje waar een figuur over de ocean surft en haaien moet ontwijken.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/game/doel-klein.jpg" alt="doel klein">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Het spel start met de boodschap "Druk Enter Om Te Spelen".</p>
</li>
<li>
<p>Tijdens het spelen</p>
<div class="ulist">
<ul>
<li>
<p>De speler kan in vier richtingen bewegen met de pijltjestoetsen.</p>
</li>
<li>
<p>Haaien verschijnen op een willekeurige hoogte en zwemmen van rechts naar links.</p>
</li>
<li>
<p>Elke 3 seconden verschijnt er een nieuwe haai.</p>
</li>
<li>
<p>Het raken van een haai vermindert het aantal levens met 1.</p>
<div class="ulist">
<ul>
<li>
<p>De speler start met 3 levens.</p>
</li>
<li>
<p>Wanneer de levens onder 0 gaan, is het spel voorbij.</p>
</li>
<li>
<p>Het resterend aantal levens wordt op het scherm getoond.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Tijdens het spelen kan het spel op pauze gezet worden met de <code>P</code> toets.</p>
</li>
<li>
<p>Wanneer het spel op pauze staat, kan men verder spelen door op <code>Enter</code> te drukken.</p>
</li>
<li>
<p>Wanneer het spel voorbij is, verschijnt de boodschap "Einde".</p>
</li>
<li>
<p>Wanneer het spel afgelopen is, kan met op <code>S</code> drukken om terug te keren naar het startscherm.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monogame"><a class="anchor" href="#_monogame"></a>Monogame</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>We kiezen voor MonoGame als ondersteunende technologie.</strong></p>
</div>
<div class="paragraph">
<p><a href="https://monogame.net/">MonoGame</a> is een <strong>framework</strong> om cross-platform videogames te programmeren in C#. <strong>MonoGame is géén <em>game engine</em>.</strong> De functionaliteit beperkt zich grofweg tot</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Abstraheren van calls naar de grafische kaart. Deze worden door het framework vertaald naar OpenGL, DirectX of Metal.</p>
</li>
<li>
<p>Abstraheren van calls naar geluidsinfrastructuur op het systeem.</p>
</li>
<li>
<p>Abstraheren van gebruikersinvoer, zoals toetsenbord en XInput.</p>
</li>
<li>
<p>Inladen van <em>assets</em>, zoals prentjes en fonts, in een efficient formaat.</p>
</li>
<li>
<p>Ter beschikking stellen van een aantal handige datastructuren zoals Rectangle, Vector2D, Texture2D en SpriteFont.</p>
</li>
<li>
<p>Voorzien van een basis klasse die een <em>game loop</em> bevat.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Je schrijft zelf alle logica in C#.</strong> Deze hoge graad van controle is interessant voor een bepaald professioneel doelpubliek én maakt het geheel didactisch verantwoord in een opleiding waar het zeker niet de bedoeling is met <em>game engines</em>, zoals Unreal of Unity, te leren werken.</p>
</div>
<div class="paragraph">
<p>Enkele games die geschreven zijn in MonoGame.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/game/stardew.jpg" alt="stardew"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/game/celeste.png" alt="celeste"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/game/axiom.png" alt="axiom"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementatie"><a class="anchor" href="#_implementatie"></a>Implementatie</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_faseles_1"><a class="anchor" href="#_faseles_1"></a>Fase/Les 1</h3>
<div class="paragraph">
<p>We implementeren alle (state) logica op klassieke wijze, zonder <em>State Pattern</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
De code wordt na afloop van de les beschikbaar gesteld op Chamilo.<br>
<br>
<a href="https://chamilo.hogent.be/index.php?go=CourseViewer&amp;application=Chamilo%5CApplication%5CWeblcms&amp;course=59982&amp;tool=Document&amp;publication_category=348226&amp;browser=Table&amp;tool_action=Viewer&amp;publication=2503238">Gent Fase 1</a> / <a href="https://chamilo.hogent.be/index.php?go=CourseViewer&amp;application=Chamilo%5CApplication%5CWeblcms&amp;course=62372&amp;tool=Document&amp;browser=Table&amp;tool_action=Viewer&amp;publication=2503941">Aalst Fase 1</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_faseles_2"><a class="anchor" href="#_faseles_2"></a>Fase/Les 2</h3>
<div class="paragraph">
<p>We voldoen aan alle requirements én refactoren de code om het <em>State Pattern</em> te gebruiken.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
De code wordt na afloop van de les beschikbaar gesteld op Chamilo.<br>
<br>
<a href="https://chamilo.hogent.be/index.php?go=CourseViewer&amp;application=Chamilo%5CApplication%5CWeblcms&amp;course=59982&amp;tool=Document&amp;publication_category=348226&amp;browser=Table&amp;tool_action=Viewer&amp;publication=2507892">Gent Fase 1.5</a> en <a href="https://chamilo.hogent.be/index.php?go=CourseViewer&amp;application=Chamilo%5CApplication%5CWeblcms&amp;course=59982&amp;tool=Document&amp;publication_category=348226&amp;browser=Table&amp;tool_action=Viewer&amp;publication=2507894">Gent Fase 2</a> / <a href="https://chamilo.hogent.be/index.php?go=CourseViewer&amp;application=Chamilo%5CApplication%5CWeblcms&amp;course=62372&amp;tool=Document&amp;browser=Table&amp;tool_action=Viewer&amp;publication=2508901">Aalst Fase 2</a>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/game/states-type-diagram.png" alt="states type diagram">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_zelf_compileren_uitvoeren"><a class="anchor" href="#_zelf_compileren_uitvoeren"></a>Zelf Compileren &amp; Uitvoeren</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Het is mogelijk om het spel op je eigen computer uit te voeren of aan te passen.</strong></p>
</div>
<div class="sect2">
<h3 id="_monogame_setup"><a class="anchor" href="#_monogame_setup"></a>MonoGame Setup</h3>
<div class="paragraph">
<p>Installeer VS Code indien je dit nog niet gedaan hebt.</p>
</div>
<div class="paragraph">
<p>Installeer de MonoGame templates</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">dotnet new install MonoGame.Templates.CSharp</code></pre>
</div>
</div>
<div class="paragraph">
<p>Installeer de C# DevKit plugin.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/game/devkit.png" alt="devkit">
</div>
</div>
<div class="paragraph">
<p>Installeer de MonoGame plugin.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/game/monogame.png" alt="monogame">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_solution_starten"><a class="anchor" href="#_solution_starten"></a>Solution Starten</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Logica en Content in dit voorbeeld is absoluut niet voldoende rijk en efficiënt om als goed voorbeeld te dienen voor game development. Het is wél een goed voorbeeld van het <em>State Pattern</em>, en daar gaat het natuurlijk over.<br>
<br>
Indien je meer wil leren over MonoGame, kan je de <a href="https://docs.monogame.net/articles/getting_to_know/howto/">documentatie</a> consulteren.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Open de Solution in VS Code.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/game/open.png" alt="open">
</div>
</div>
<div class="paragraph">
<p>Restore het project om de nodige dependencies en tools te installeren.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/game/restore.png" alt="restore">
</div>
</div>
<div class="paragraph">
<p>Run (en build impliciet) het project.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/game/run.png" alt="run">
</div>
</div>
<div class="paragraph">
<p>Als het goed zit, start het spelletje op.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/game/running.png" alt="running">
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using a customized version of the Antora default UI.</p>
  <p>The source code for the default UI is licensed under the terms of the MPL-2.0 license.</p>
    <p>Content by Stefan Courteaux unless otherwise noted. </p>
</footer>
<script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
